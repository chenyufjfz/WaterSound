
#include "cuda_runtime.h"
#include "device_launch_parameters.h"
#include "SpaceFilter.h"
#include "WaterSndProcess.h"
#include <stdio.h>
#include <time.h>


static short N_t[180 * CHANNEL_NUM] = { 0, 64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 896, 960, 1024,
1088, 1152, 1216, 1280, 1344, 1408, 1472, 1536, 1600, 1664, 1728, 1792, 1856, 1920, 1984, 2048, 2112,
2176, 2240, 2304, 2368, 2432, 2496, 0, 64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832,
896, 960, 1024, 1088, 1152, 1216, 1280, 1344, 1408, 1472, 1536, 1600, 1664, 1728, 1792, 1856, 1920, 1984,
2048, 2112, 2176, 2240, 2304, 2368, 2432, 2496, 0, 64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768,
831, 895, 959, 1023, 1087, 1151, 1215, 1279, 1343, 1407, 1471, 1535, 1599, 1663, 1727, 1791, 1855, 1919, 1983,
2047, 2111, 2175, 2239, 2303, 2367, 2431, 2494, 0, 64, 128, 192, 256, 320, 383, 447, 511, 575, 639, 703, 767,
831, 895, 959, 1023, 1087, 1150, 1214, 1278, 1342, 1406, 1470, 1534, 1598, 1662, 1726, 1790, 1853, 1917, 1981,
2045, 2109, 2173, 2237, 2301, 2365, 2429, 2493, 0, 64, 128, 192, 255, 319, 383, 447, 511, 575, 638, 702, 766,
830, 894, 958, 1022, 1085, 1149, 1213, 1277, 1341, 1405, 1468, 1532, 1596, 1660, 1724, 1788, 1851, 1915, 1979,
2043, 2107, 2171, 2235, 2298, 2362, 2426, 2490, 0, 64, 128, 191, 255, 319, 383, 446, 510, 574, 638, 701, 765,
829, 893, 956, 1020, 1084, 1148, 1211, 1275, 1339, 1403, 1466, 1530, 1594, 1658, 1721, 1785, 1849, 1913, 1976,
2040, 2104, 2168, 2231, 2295, 2359, 2423, 2487, 0, 64, 127, 191, 255, 318, 382, 446, 509, 573, 636, 700, 764,
827, 891, 955, 1018, 1082, 1146, 1209, 1273, 1337, 1400, 1464, 1528, 1591, 1655, 1719, 1782, 1846, 1909, 1973,
2037, 2100, 2164, 2228, 2291, 2355, 2419, 2482, 0, 64, 127, 191, 254, 318, 381, 445, 508, 572, 635, 699, 762,
826, 889, 953, 1016, 1080, 1143, 1207, 1270, 1334, 1398, 1461, 1525, 1588, 1652, 1715, 1779, 1842, 1906, 1969,
2033, 2096, 2160, 2223, 2287, 2350, 2414, 2477, 0, 63, 127, 190, 254, 317, 380, 444, 507, 570, 634, 697, 761,
824, 887, 951, 1014, 1077, 1141, 1204, 1268, 1331, 1394, 1458, 1521, 1584, 1648, 1711, 1775, 1838, 1901, 1965,
2028, 2091, 2155, 2218, 2282, 2345, 2408, 2472, 0, 63, 126, 190, 253, 316, 379, 442, 506, 569, 632, 695, 759,
822, 885, 948, 1011, 1075, 1138, 1201, 1264, 1327, 1391, 1454, 1517, 1580, 1644, 1707, 1770, 1833, 1896, 1960,
2023, 2086, 2149, 2212, 2276, 2339, 2402, 2465, 0, 63, 126, 189, 252, 315, 378, 441, 504, 567, 630, 693, 756,
819, 882, 945, 1008, 1071, 1134, 1198, 1261, 1324, 1387, 1450, 1513, 1576, 1639, 1702, 1765, 1828, 1891, 1954,
2017, 2080, 2143, 2206, 2269, 2332, 2395, 2458, 0, 63, 126, 188, 251, 314, 377, 440, 503, 565, 628, 691, 754,
817, 880, 942, 1005, 1068, 1131, 1194, 1256, 1319, 1382, 1445, 1508, 1571, 1633, 1696, 1759, 1822, 1885, 1948,
2010, 2073, 2136, 2199, 2262, 2324, 2387, 2450, 0, 63, 125, 188, 250, 313, 376, 438, 501, 563, 626, 689, 751,
814, 876, 939, 1002, 1064, 1127, 1189, 1252, 1315, 1377, 1440, 1502, 1565, 1628, 1690, 1753, 1815, 1878, 1941,
2003, 2066, 2128, 2191, 2254, 2316, 2379, 2441, 0, 62, 125, 187, 249, 312, 374, 437, 499, 561, 624, 686, 748,
811, 873, 935, 998, 1060, 1122, 1185, 1247, 1310, 1372, 1434, 1497, 1559, 1621, 1684, 1746, 1808, 1871, 1933,
1996, 2058, 2120, 2183, 2245, 2307, 2370, 2432, 0, 62, 124, 186, 248, 310, 373, 435, 497, 559, 621, 683, 745,
807, 869, 931, 994, 1056, 1118, 1180, 1242, 1304, 1366, 1428, 1490, 1552, 1615, 1677, 1739, 1801, 1863, 1925,
1987, 2049, 2111, 2173, 2236, 2298, 2360, 2422, 0, 62, 124, 185, 247, 309, 371, 433, 495, 556, 618, 680, 742,
804, 865, 927, 989, 1051, 1113, 1175, 1236, 1298, 1360, 1422, 1484, 1545, 1607, 1669, 1731, 1793, 1855, 1916,
1978, 2040, 2102, 2164, 2225, 2287, 2349, 2411, 0, 62, 123, 185, 246, 308, 369, 431, 492, 554, 615, 677, 738,
800, 861, 923, 984, 1046, 1107, 1169, 1230, 1292, 1353, 1415, 1476, 1538, 1600, 1661, 1723, 1784, 1846, 1907,
1969, 2030, 2092, 2153, 2215, 2276, 2338, 2399, 0, 61, 122, 184, 245, 306, 367, 428, 490, 551, 612, 673, 734,
796, 857, 918, 979, 1040, 1102, 1163, 1224, 1285, 1346, 1408, 1469, 1530, 1591, 1652, 1714, 1775, 1836, 1897,
1959, 2020, 2081, 2142, 2203, 2265, 2326, 2387, 0, 61, 122, 183, 243, 304, 365, 426, 487, 548, 609, 670, 730,
791, 852, 913, 974, 1035, 1096, 1156, 1217, 1278, 1339, 1400, 1461, 1522, 1583, 1643, 1704, 1765, 1826, 1887,
1948, 2009, 2069, 2130, 2191, 2252, 2313, 2374, 0, 61, 121, 182, 242, 303, 363, 424, 484, 545, 605, 666, 726,
787, 847, 908, 968, 1029, 1089, 1150, 1210, 1271, 1331, 1392, 1452, 1513, 1573, 1634, 1694, 1755, 1815, 1876,
1936, 1997, 2057, 2118, 2178, 2239, 2300, 2360, 0, 60, 120, 180, 241, 301, 361, 421, 481, 541, 601, 662, 722,
782, 842, 902, 962, 1022, 1083, 1143, 1203, 1263, 1323, 1383, 1443, 1504, 1564, 1624, 1684, 1744, 1804, 1864,
1924, 1985, 2045, 2105, 2165, 2225, 2285, 2345, 0, 60, 119, 179, 239, 299, 358, 418, 478, 538, 597, 657, 717,
777, 836, 896, 956, 1016, 1075, 1135, 1195, 1255, 1314, 1374, 1434, 1494, 1553, 1613, 1673, 1733, 1792, 1852,
1912, 1972, 2031, 2091, 2151, 2211, 2270, 2330, 0, 59, 119, 178, 237, 297, 356, 415, 475, 534, 593, 653, 712,
771, 831, 890, 949, 1009, 1068, 1127, 1187, 1246, 1305, 1365, 1424, 1483, 1543, 1602, 1662, 1721, 1780, 1840,
1899, 1958, 2018, 2077, 2136, 2196, 2255, 2314, 0, 59, 118, 177, 236, 295, 353, 412, 471, 530, 589, 648, 707,
766, 825, 884, 943, 1002, 1060, 1119, 1178, 1237, 1296, 1355, 1414, 1473, 1532, 1591, 1650, 1708, 1767, 1826,
1885, 1944, 2003, 2062, 2121, 2180, 2239, 2298, 0, 58, 117, 175, 234, 292, 351, 409, 468, 526, 585, 643, 702,
760, 819, 877, 935, 994, 1052, 1111, 1169, 1228, 1286, 1345, 1403, 1462, 1520, 1579, 1637, 1696, 1754, 1812,
1871, 1929, 1988, 2046, 2105, 2163, 2222, 2280, 0, 58, 116, 174, 232, 290, 348, 406, 464, 522, 580, 638, 696,
754, 812, 870, 928, 986, 1044, 1102, 1160, 1218, 1276, 1334, 1392, 1450, 1508, 1566, 1624, 1682, 1740, 1798,
1856, 1914, 1972, 2030, 2088, 2146, 2204, 2262, 0, 58, 115, 173, 230, 288, 345, 403, 460, 518, 575, 633, 690,
748, 805, 863, 920, 978, 1035, 1093, 1150, 1208, 1266, 1323, 1381, 1438, 1496, 1553, 1611, 1668, 1726, 1783,
1841, 1898, 1956, 2013, 2071, 2128, 2186, 2243, 0, 57, 114, 171, 228, 285, 342, 399, 456, 513, 570, 627, 684,
741, 798, 855, 912, 969, 1026, 1083, 1140, 1198, 1255, 1312, 1369, 1426, 1483, 1540, 1597, 1654, 1711, 1768,
1825, 1882, 1939, 1996, 2053, 2110, 2167, 2224, 0, 57, 113, 170, 226, 283, 339, 396, 452, 509, 565, 622, 678,
735, 791, 848, 904, 961, 1017, 1074, 1130, 1187, 1243, 1300, 1356, 1413, 1469, 1526, 1582, 1639, 1695, 1752,
1808, 1865, 1921, 1978, 2034, 2091, 2147, 2204, 0, 56, 112, 168, 224, 280, 336, 392, 448, 504, 560, 616, 672,
728, 784, 840, 896, 952, 1008, 1064, 1120, 1175, 1231, 1287, 1343, 1399, 1455, 1511, 1567, 1623, 1679, 1735,
1791, 1847, 1903, 1959, 2015, 2071, 2127, 2183, 0, 55, 111, 166, 222, 277, 333, 388, 443, 499, 554, 610, 665,
721, 776, 831, 887, 942, 998, 1053, 1109, 1164, 1219, 1275, 1330, 1386, 1441, 1496, 1552, 1607, 1663, 1718,
1774, 1829, 1884, 1940, 1995, 2051, 2106, 2162, 0, 55, 110, 165, 219, 274, 329, 384, 439, 494, 549, 603, 658,
713, 768, 823, 878, 933, 987, 1042, 1097, 1152, 1207, 1262, 1317, 1371, 1426, 1481, 1536, 1591, 1646, 1701,
1755, 1810, 1865, 1920, 1975, 2030, 2085, 2139, 0, 54, 109, 163, 217, 271, 326, 380, 434, 488, 543, 597, 651,
706, 760, 814, 868, 923, 977, 1031, 1086, 1140, 1194, 1248, 1303, 1357, 1411, 1465, 1520, 1574, 1628, 1683,
1737, 1791, 1845, 1900, 1954, 2008, 2062, 2117, 0, 54, 107, 161, 215, 268, 322, 376, 429, 483, 537, 590, 644,
698, 751, 805, 859, 912, 966, 1020, 1073, 1127, 1181, 1235, 1288, 1342, 1396, 1449, 1503, 1557, 1610, 1664,
1718, 1771, 1825, 1879, 1932, 1986, 2040, 2093, 0, 53, 106, 159, 212, 265, 318, 371, 424, 478, 531, 584, 637,
690, 743, 796, 849, 902, 955, 1008, 1061, 1114, 1167, 1220, 1273, 1326, 1380, 1433, 1486, 1539, 1592, 1645,
1698, 1751, 1804, 1857, 1910, 1963, 2016, 2069, 0, 52, 105, 157, 210, 262, 315, 367, 419, 472, 524, 577, 629,
682, 734, 786, 839, 891, 944, 996, 1049, 1101, 1153, 1206, 1258, 1311, 1363, 1415, 1468, 1520, 1573, 1625,
1678, 1730, 1782, 1835, 1887, 1940, 1992, 2045, 0, 52, 104, 155, 207, 259, 311, 362, 414, 466, 518, 570, 621,
673, 725, 777, 828, 880, 932, 984, 1036, 1087, 1139, 1191, 1243, 1294, 1346, 1398, 1450, 1502, 1553, 1605, 1657,
1709, 1760, 1812, 1864, 1916, 1968, 2019, 0, 51, 102, 153, 204, 256, 307, 358, 409, 460, 511, 562, 613, 664,
716, 767, 818, 869, 920, 971, 1022, 1073, 1124, 1176, 1227, 1278, 1329, 1380, 1431, 1482, 1533, 1584, 1636, 1687,
1738, 1789, 1840, 1891, 1942, 1993, 0, 50, 101, 151, 202, 252, 303, 353, 403, 454, 504, 555, 605, 656, 706, 756,
807, 857, 908, 958, 1009, 1059, 1110, 1160, 1210, 1261, 1311, 1362, 1412, 1463, 1513, 1563, 1614, 1664, 1715,
1765, 1816, 1866, 1916, 1967, 0, 50, 99, 149, 199, 249, 298, 348, 398, 448, 497, 547, 597, 647, 696, 746, 796,
846, 895, 945, 995, 1044, 1094, 1144, 1194, 1243, 1293, 1343, 1393, 1442, 1492, 1542, 1592, 1641, 1691, 1741, 1791,
1840, 1890, 1940, 0, 49, 98, 147, 196, 245, 294, 343, 392, 441, 490, 539, 588, 637, 686, 735, 784, 833, 882, 932,
981, 1030, 1079, 1128, 1177, 1226, 1275, 1324, 1373, 1422, 1471, 1520, 1569, 1618, 1667, 1716, 1765, 1814, 1863,
1912, 0, 48, 97, 145, 193, 242, 290, 338, 386, 435, 483, 531, 580, 628, 676, 725, 773, 821, 869, 918, 966, 1014,
1063, 1111, 1159, 1208, 1256, 1304, 1352, 1401, 1449, 1497, 1546, 1594, 1642, 1691, 1739, 1787, 1835, 1884, 0, 48,
95, 143, 190, 238, 285, 333, 380, 428, 476, 523, 571, 618, 666, 713, 761, 809, 856, 904, 951, 999, 1046, 1094, 1141,
1189, 1237, 1284, 1332, 1379, 1427, 1474, 1522, 1570, 1617, 1665, 1712, 1760, 1807, 1855, 0, 47, 94, 140, 187, 234,
281, 328, 374, 421, 468, 515, 562, 608, 655, 702, 749, 796, 843, 889, 936, 983, 1030, 1077, 1123, 1170, 1217, 1264,
1311, 1357, 1404, 1451, 1498, 1545, 1591, 1638, 1685, 1732, 1779, 1825, 0, 46, 92, 138, 184, 230, 276, 322, 368, 414,
460, 506, 552, 598, 645, 691, 737, 783, 829, 875, 921, 967, 1013, 1059, 1105, 1151, 1197, 1243, 1289, 1335, 1381, 1427,
1473, 1519, 1565, 1611, 1657, 1703, 1749, 1795, 0, 45, 91, 136, 181, 226, 272, 317, 362, 407, 453, 498, 543, 588, 634,
679, 724, 769, 815, 860, 905, 950, 996, 1041, 1086, 1131, 1177, 1222, 1267, 1312, 1358, 1403, 1448, 1493, 1539, 1584,
1629, 1674, 1720, 1765, 0, 44, 89, 133, 178, 222, 267, 311, 356, 400, 445, 489, 533, 578, 622, 667, 711, 756, 800, 845,
889, 934, 978, 1023, 1067, 1111, 1156, 1200, 1245, 1289, 1334, 1378, 1423, 1467, 1512, 1556, 1600, 1645, 1689, 1734, 0,
44, 87, 131, 175, 218, 262, 306, 349, 393, 436, 480, 524, 567, 611, 655, 698, 742, 786, 829, 873, 917, 960, 1004, 1048,
1091, 1135, 1178, 1222, 1266, 1309, 1353, 1397, 1440, 1484, 1528, 1571, 1615, 1659, 1702, 0, 43, 86, 128, 171, 214, 257,
300, 343, 385, 428, 471, 514, 557, 600, 642, 685, 728, 771, 814, 856, 899, 942, 985, 1028, 1071, 1113, 1156, 1199, 1242,
1285, 1328, 1370, 1413, 1456, 1499, 1542, 1585, 1627, 1670, 0, 42, 84, 126, 168, 210, 252, 294, 336, 378, 420, 462, 504,
546, 588, 630, 672, 714, 756, 798, 840, 882, 924, 966, 1008, 1050, 1092, 1134, 1176, 1218, 1260, 1302, 1344, 1386, 1428,
1470, 1512, 1554, 1596, 1638, 0, 41, 82, 123, 165, 206, 247, 288, 329, 370, 411, 453, 494, 535, 576, 617, 658, 699, 740,
782, 823, 864, 905, 946, 987, 1028, 1070, 1111, 1152, 1193, 1234, 1275, 1316, 1358, 1399, 1440, 1481, 1522, 1563, 1604,
0, 40, 81, 121, 161, 201, 242, 282, 322, 362, 403, 443, 483, 524, 564, 604, 644, 685, 725, 765, 806, 846, 886, 926, 967,
1007, 1047, 1087, 1128, 1168, 1208, 1249, 1289, 1329, 1369, 1410, 1450, 1490, 1531, 1571, 0, 39, 79, 118, 158, 197, 236,
276, 315, 355, 394, 433, 473, 512, 552, 591, 630, 670, 709, 749, 788, 827, 867, 906, 946, 985, 1024, 1064, 1103, 1143,
1182, 1221, 1261, 1300, 1340, 1379, 1418, 1458, 1497, 1537, 0, 39, 77, 116, 154, 193, 231, 270, 308, 347, 385, 424, 462,
501, 539, 578, 616, 655, 693, 732, 770, 809, 847, 886, 924, 963, 1001, 1040, 1078, 1117, 1155, 1194, 1233, 1271, 1310,
1348, 1387, 1425, 1464, 1502, 0, 38, 75, 113, 150, 188, 226, 263, 301, 339, 376, 414, 451, 489, 527, 564, 602, 640, 677,
715, 752, 790, 828, 865, 903, 940, 978, 1016, 1053, 1091, 1129, 1166, 1204, 1241, 1279, 1317, 1354, 1392, 1429, 1467,
0, 37, 73, 110, 147, 184, 220, 257, 294, 330, 367, 404, 441, 477, 514, 551, 587, 624, 661, 697, 734, 771, 808, 844, 881,
918, 954, 991, 1028, 1065, 1101, 1138, 1175, 1211, 1248, 1285, 1322, 1358, 1395, 1432, 0, 36, 72, 107, 143, 179, 215,
251, 286, 322, 358, 394, 429, 465, 501, 537, 573, 608, 644, 680, 716, 752, 787, 823, 859, 895, 930, 966, 1002, 1038,
1074, 1109, 1145, 1181, 1217, 1253, 1288, 1324, 1360, 1396, 0, 35, 70, 105, 139, 174, 209, 244, 279, 314, 349, 383, 418,
453, 488, 523, 558, 593, 627, 662, 697, 732, 767, 802, 837, 871, 906, 941, 976, 1011, 1046, 1081, 1115, 1150, 1185, 1220,
1255, 1290, 1325, 1359, 0, 34, 68, 102, 136, 170, 203, 237, 271, 305, 339, 373, 407, 441, 475, 509, 543, 577, 610, 644,
678, 712, 746, 780, 814, 848, 882, 916, 950, 984, 1017, 1051, 1085, 1119, 1153, 1187, 1221, 1255, 1289, 1323, 0, 33, 66,
99, 132, 165, 198, 231, 264, 297, 330, 363, 396, 429, 461, 494, 527, 560, 593, 626, 659, 692, 725, 758, 791, 824, 857,
890, 923, 956, 989, 1022, 1055, 1088, 1121, 1154, 1187, 1220, 1253, 1286, 0, 32, 64, 96, 128, 160, 192, 224, 256, 288,
320, 352, 384, 416, 448, 480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800, 832, 864, 896, 928, 960, 992, 1024,
1056, 1088, 1120, 1152, 1184, 1216, 1248, 0, 31, 62, 93, 124, 155, 186, 217, 248, 279, 310, 341, 372, 403, 434, 465,
496, 527, 559, 590, 621, 652, 683, 714, 745, 776, 807, 838, 869, 900, 931, 962, 993, 1024, 1055, 1086, 1117, 1148, 1179,
1210, 0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 331, 361, 391, 421, 451, 481, 511, 541, 571, 601, 631, 661, 691,
721, 751, 781, 811, 841, 871, 901, 931, 961, 992, 1022, 1052, 1082, 1112, 1142, 1172, 0, 29, 58, 87, 116, 145, 174, 203,
232, 261, 291, 320, 349, 378, 407, 436, 465, 494, 523, 552, 581, 610, 639, 668, 697, 726, 755, 784, 814, 843, 872, 901,
930, 959, 988, 1017, 1046, 1075, 1104, 1133, 0, 28, 56, 84, 112, 140, 168, 196, 224, 253, 281, 309, 337, 365, 393, 421,
449, 477, 505, 533, 561, 589, 617, 645, 673, 701, 729, 758, 786, 814, 842, 870, 898, 926, 954, 982, 1010, 1038, 1066,
1094, 0, 27, 54, 81, 108, 135, 162, 189, 216, 243, 270, 298, 325, 352, 379, 406, 433, 460, 487, 514, 541, 568, 595, 622,
649, 676, 703, 730, 757, 784, 811, 838, 866, 893, 920, 947, 974, 1001, 1028, 1055, 0, 26, 52, 78, 104, 130, 156, 182,
208, 234, 260, 286, 312, 338, 364, 390, 416, 443, 469, 495, 521, 547, 573, 599, 625, 651, 677, 703, 729, 755, 781, 807,
833, 859, 885, 911, 937, 963, 989, 1015, 0, 25, 50, 75, 100, 125, 150, 175, 200, 225, 250, 275, 300, 325, 350, 375, 400,
425, 450, 475, 500, 525, 550, 575, 600, 625, 650, 675, 700, 725, 750, 775, 800, 825, 850, 875, 900, 925, 950, 975, 0,
24, 48, 72, 96, 120, 144, 168, 192, 216, 240, 264, 288, 312, 336, 360, 384, 408, 432, 456, 479, 503, 527, 551, 575, 599,
623, 647, 671, 695, 719, 743, 767, 791, 815, 839, 863, 887, 911, 935, 0, 23, 46, 69, 92, 115, 138, 161, 183, 206, 229,
252, 275, 298, 321, 344, 367, 390, 413, 436, 459, 482, 505, 528, 550, 573, 596, 619, 642, 665, 688, 711, 734, 757, 780,
803, 826, 849, 872, 894, 0, 22, 44, 66, 88, 109, 131, 153, 175, 197, 219, 241, 263, 285, 306, 328, 350, 372, 394, 416,
438, 460, 482, 503, 525, 547, 569, 591, 613, 635, 657, 679, 700, 722, 744, 766, 788, 810, 832, 854, 0, 21, 42, 63, 83,
104, 125, 146, 167, 188, 208, 229, 250, 271, 292, 313, 333, 354, 375, 396, 417, 438, 458, 479, 500, 521, 542, 563, 583,
604, 625, 646, 667, 688, 708, 729, 750, 771, 792, 813, 0, 20, 40, 59, 79, 99, 119, 138, 158, 178, 198, 218, 237, 257,
277, 297, 316, 336, 356, 376, 396, 415, 435, 455, 475, 494, 514, 534, 554, 574, 593, 613, 633, 653, 672, 692, 712, 732,
752, 771, 0, 19, 37, 56, 75, 94, 112, 131, 150, 168, 187, 206, 225, 243, 262, 281, 299, 318, 337, 356, 374, 393, 412,
430, 449, 468, 487, 505, 524, 543, 561, 580, 599, 617, 636, 655, 674, 692, 711, 730, 0, 18, 35, 53, 71, 88, 106, 123,
141, 159, 176, 194, 212, 229, 247, 265, 282, 300, 318, 335, 353, 370, 388, 406, 423, 441, 459, 476, 494, 512, 529, 547,
565, 582, 600, 617, 635, 653, 670, 688, 0, 17, 33, 50, 66, 83, 99, 116, 133, 149, 166, 182, 199, 215, 232, 248, 265,
282, 298, 315, 331, 348, 364, 381, 398, 414, 431, 447, 464, 480, 497, 513, 530, 547, 563, 580, 596, 613, 629, 646, 0,
15, 31, 46, 62, 77, 93, 108, 124, 139, 155, 170, 186, 201, 217, 232, 248, 263, 279, 294, 310, 325, 341, 356, 372, 387,
403, 418, 434, 449, 464, 480, 495, 511, 526, 542, 557, 573, 588, 604, 0, 14, 29, 43, 58, 72, 86, 101, 115, 130, 144,
158, 173, 187, 202, 216, 230, 245, 259, 274, 288, 302, 317, 331, 346, 360, 374, 389, 403, 418, 432, 446, 461, 475,
489, 504, 518, 533, 547, 561, 0, 13, 27, 40, 53, 67, 80, 93, 106, 120, 133, 146, 160, 173, 186, 200, 213, 226, 240,
253, 266, 279, 293, 306, 319, 333, 346, 359, 373, 386, 399, 412, 426, 439, 452, 466, 479, 492, 506, 519, 0, 12, 24,
37, 49, 61, 73, 85, 98, 110, 122, 134, 147, 159, 171, 183, 195, 208, 220, 232, 244, 256, 269, 281, 293, 305, 318, 330,
342, 354, 366, 379, 391, 403, 415, 427, 440, 452, 464, 476, 0, 11, 22, 33, 44, 56, 67, 78, 89, 100, 111, 122, 133, 144,
156, 167, 178, 189, 200, 211, 222, 233, 244, 256, 267, 278, 289, 300, 311, 322, 333, 345, 356, 367, 378, 389, 400, 411,
422, 433, 0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230,
240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 0, 9, 18, 27, 36, 45, 53, 62, 71, 80,
89, 98, 107, 116, 125, 134, 143, 151, 160, 169, 178, 187, 196, 205, 214, 223, 232, 240, 249, 258, 267, 276, 285, 294,
303, 312, 321, 330, 338, 347, 0, 8, 16, 23, 31, 39, 47, 55, 62, 70, 78, 86, 94, 101, 109, 117, 125, 133, 140, 148,
156, 164, 172, 179, 187, 195, 203, 211, 218, 226, 234, 242, 250, 257, 265, 273, 281, 289, 296, 304, 0, 7, 13, 20, 27,
33, 40, 47, 54, 60, 67, 74, 80, 87, 94, 100, 107, 114, 120, 127, 134, 140, 147, 154, 161, 167, 174, 181, 187, 194, 201,
207, 214, 221, 227, 234, 241, 248, 254, 261, 0, 6, 11, 17, 22, 28, 33, 39, 45, 50, 56, 61, 67, 73, 78, 84, 89, 95, 100,
106, 112, 117, 123, 128, 134, 139, 145, 151, 156, 162, 167, 173, 178, 184, 190, 195, 201, 206, 212, 218, 0, 4, 9, 13,
18, 22, 27, 31, 36, 40, 45, 49, 54, 58, 63, 67, 71, 76, 80, 85, 89, 94, 98, 103, 107, 112, 116, 121, 125, 129, 134,
138, 143, 147, 152, 156, 161, 165, 170, 174, 0, 3, 7, 10, 13, 17, 20, 23, 27, 30, 33, 37, 40, 44, 47, 50, 54, 57, 60,
64, 67, 70, 74, 77, 80, 84, 87, 90, 94, 97, 100, 104, 107, 111, 114, 117, 121, 124, 127, 131, 0, 2, 4, 7, 9, 11, 13,
16, 18, 20, 22, 25, 27, 29, 31, 34, 36, 38, 40, 42, 45, 47, 49, 51, 54, 56, 58, 60, 63, 65, 67, 69, 71, 74, 76, 78,
80, 83, 85, 87, 0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29,
30, 31, 32, 34, 35, 36, 37, 38, 39, 40, 41, 42, 44, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -2, -3, -4, -6, -7, -8, -9, -10, -11, -12, -13, -15,
-16, -17, -18, -19, -20, -21, -22, -23, -25, -26, -27, -28, -29, -30, -31, -32, -34, -35, -36, -37, -38, -39, -40,
-41, -42, -44, 0, -2, -4, -7, -9, -11, -13, -16, -18, -20, -22, -25, -27, -29, -31, -34, -36, -38, -40, -42, -45,
-47, -49, -51, -54, -56, -58, -60, -63, -65, -67, -69, -71, -74, -76, -78, -80, -83, -85, -87, 0, -3, -7, -10, -13,
-17, -20, -23, -27, -30, -33, -37, -40, -44, -47, -50, -54, -57, -60, -64, -67, -70, -74, -77, -80, -84, -87, -90,
-94, -97, -100, -104, -107, -111, -114, -117, -121, -124, -127, -131, 0, -4, -9, -13, -18, -22, -27, -31, -36, -40,
-45, -49, -54, -58, -63, -67, -71, -76, -80, -85, -89, -94, -98, -103, -107, -112, -116, -121, -125, -129, -134,
-138, -143, -147, -152, -156, -161, -165, -170, -174, 0, -6, -11, -17, -22, -28, -33, -39, -45, -50, -56, -61, -67,
-73, -78, -84, -89, -95, -100, -106, -112, -117, -123, -128, -134, -139, -145, -151, -156, -162, -167, -173, -178,
-184, -190, -195, -201, -206, -212, -218, 0, -7, -13, -20, -27, -33, -40, -47, -54, -60, -67, -74, -80, -87, -94,
-100, -107, -114, -120, -127, -134, -140, -147, -154, -161, -167, -174, -181, -187, -194, -201, -207, -214, -221,
-227, -234, -241, -248, -254, -261, 0, -8, -16, -23, -31, -39, -47, -55, -62, -70, -78, -86, -94, -101, -109, -117,
-125, -133, -140, -148, -156, -164, -172, -179, -187, -195, -203, -211, -218, -226, -234, -242, -250, -257, -265,
-273, -281, -289, -296, -304, 0, -9, -18, -27, -36, -45, -53, -62, -71, -80, -89, -98, -107, -116, -125, -134, -143,
-151, -160, -169, -178, -187, -196, -205, -214, -223, -232, -240, -249, -258, -267, -276, -285, -294, -303, -312,
-321, -330, -338, -347, 0, -10, -20, -30, -40, -50, -60, -70, -80, -90, -100, -110, -120, -130, -140, -150, -160,
-170, -180, -190, -200, -210, -220, -230, -240, -250, -260, -270, -280, -290, -300, -310, -320, -330, -340, -350,
-360, -370, -380, -390, 0, -11, -22, -33, -44, -56, -67, -78, -89, -100, -111, -122, -133, -144, -156, -167, -178,
-189, -200, -211, -222, -233, -244, -256, -267, -278, -289, -300, -311, -322, -333, -345, -356, -367, -378, -389,
-400, -411, -422, -433, 0, -12, -24, -37, -49, -61, -73, -85, -98, -110, -122, -134, -147, -159, -171, -183, -195,
-208, -220, -232, -244, -256, -269, -281, -293, -305, -318, -330, -342, -354, -366, -379, -391, -403, -415, -427,
-440, -452, -464, -476, 0, -13, -27, -40, -53, -67, -80, -93, -106, -120, -133, -146, -160, -173, -186, -200, -213,
-226, -240, -253, -266, -279, -293, -306, -319, -333, -346, -359, -373, -386, -399, -412, -426, -439, -452, -466,
-479, -492, -506, -519, 0, -14, -29, -43, -58, -72, -86, -101, -115, -130, -144, -158, -173, -187, -202, -216, -230,
-245, -259, -274, -288, -302, -317, -331, -346, -360, -374, -389, -403, -418, -432, -446, -461, -475, -489, -504,
-518, -533, -547, -561, 0, -15, -31, -46, -62, -77, -93, -108, -124, -139, -155, -170, -186, -201, -217, -232, -248,
-263, -279, -294, -310, -325, -341, -356, -372, -387, -403, -418, -434, -449, -464, -480, -495, -511, -526, -542,
-557, -573, -588, -604, 0, -17, -33, -50, -66, -83, -99, -116, -133, -149, -166, -182, -199, -215, -232, -248, -265,
-282, -298, -315, -331, -348, -364, -381, -398, -414, -431, -447, -464, -480, -497, -513, -530, -547, -563, -580,
-596, -613, -629, -646, 0, -18, -35, -53, -71, -88, -106, -123, -141, -159, -176, -194, -212, -229, -247, -265, -282,
-300, -318, -335, -353, -370, -388, -406, -423, -441, -459, -476, -494, -512, -529, -547, -565, -582, -600, -617,
-635, -653, -670, -688, 0, -19, -37, -56, -75, -94, -112, -131, -150, -168, -187, -206, -225, -243, -262, -281,
-299, -318, -337, -356, -374, -393, -412, -430, -449, -468, -487, -505, -524, -543, -561, -580, -599, -617, -636,
-655, -674, -692, -711, -730, 0, -20, -40, -59, -79, -99, -119, -138, -158, -178, -198, -218, -237, -257, -277, -297,
-316, -336, -356, -376, -396, -415, -435, -455, -475, -494, -514, -534, -554, -574, -593, -613, -633, -653, -672,
-692, -712, -732, -752, -771, 0, -21, -42, -63, -83, -104, -125, -146, -167, -188, -208, -229, -250, -271, -292, -313,
-333, -354, -375, -396, -417, -438, -458, -479, -500, -521, -542, -563, -583, -604, -625, -646, -667, -688, -708, -729,
-750, -771, -792, -813, 0, -22, -44, -66, -88, -109, -131, -153, -175, -197, -219, -241, -263, -285, -306, -328, -350,
-372, -394, -416, -438, -460, -482, -503, -525, -547, -569, -591, -613, -635, -657, -679, -700, -722, -744, -766, -788,
-810, -832, -854, 0, -23, -46, -69, -92, -115, -138, -161, -183, -206, -229, -252, -275, -298, -321, -344, -367, -390,
-413, -436, -459, -482, -505, -528, -550, -573, -596, -619, -642, -665, -688, -711, -734, -757, -780, -803, -826, -849,
-872, -894, 0, -24, -48, -72, -96, -120, -144, -168, -192, -216, -240, -264, -288, -312, -336, -360, -384, -408, -432,
-456, -479, -503, -527, -551, -575, -599, -623, -647, -671, -695, -719, -743, -767, -791, -815, -839, -863, -887, -911,
-935, 0, -25, -50, -75, -100, -125, -150, -175, -200, -225, -250, -275, -300, -325, -350, -375, -400, -425, -450, -475,
-500, -525, -550, -575, -600, -625, -650, -675, -700, -725, -750, -775, -800, -825, -850, -875, -900, -925, -950, -975,
0, -26, -52, -78, -104, -130, -156, -182, -208, -234, -260, -286, -312, -338, -364, -390, -416, -443, -469, -495, -521,
-547, -573, -599, -625, -651, -677, -703, -729, -755, -781, -807, -833, -859, -885, -911, -937, -963, -989, -1015, 0,
-27, -54, -81, -108, -135, -162, -189, -216, -243, -270, -298, -325, -352, -379, -406, -433, -460, -487, -514, -541,
-568, -595, -622, -649, -676, -703, -730, -757, -784, -811, -838, -866, -893, -920, -947, -974, -1001, -1028, -1055, 0,
-28, -56, -84, -112, -140, -168, -196, -224, -253, -281, -309, -337, -365, -393, -421, -449, -477, -505, -533, -561,
-589, -617, -645, -673, -701, -729, -758, -786, -814, -842, -870, -898, -926, -954, -982, -1010, -1038, -1066, -1094,
0, -29, -58, -87, -116, -145, -174, -203, -232, -261, -291, -320, -349, -378, -407, -436, -465, -494, -523, -552, -581,
-610, -639, -668, -697, -726, -755, -784, -814, -843, -872, -901, -930, -959, -988, -1017, -1046, -1075, -1104, -1133,
0, -30, -60, -90, -120, -150, -180, -210, -240, -270, -300, -331, -361, -391, -421, -451, -481, -511, -541, -571, -601,
-631, -661, -691, -721, -751, -781, -811, -841, -871, -901, -931, -961, -992, -1022, -1052, -1082, -1112, -1142, -1172,
0, -31, -62, -93, -124, -155, -186, -217, -248, -279, -310, -341, -372, -403, -434, -465, -496, -527, -559, -590, -621,
-652, -683, -714, -745, -776, -807, -838, -869, -900, -931, -962, -993, -1024, -1055, -1086, -1117, -1148, -1179, -1210,
0, -32, -64, -96, -128, -160, -192, -224, -256, -288, -320, -352, -384, -416, -448, -480, -512, -544, -576, -608, -640,
-672, -704, -736, -768, -800, -832, -864, -896, -928, -960, -992, -1024, -1056, -1088, -1120, -1152, -1184, -1216, -1248,
0, -33, -66, -99, -132, -165, -198, -231, -264, -297, -330, -363, -396, -429, -461, -494, -527, -560, -593, -626, -659,
-692, -725, -758, -791, -824, -857, -890, -923, -956, -989, -1022, -1055, -1088, -1121, -1154, -1187, -1220, -1253, -1286,
0, -34, -68, -102, -136, -170, -203, -237, -271, -305, -339, -373, -407, -441, -475, -509, -543, -577, -610, -644, -678,
-712, -746, -780, -814, -848, -882, -916, -950, -984, -1017, -1051, -1085, -1119, -1153, -1187, -1221, -1255, -1289,
-1323, 0, -35, -70, -105, -139, -174, -209, -244, -279, -314, -349, -383, -418, -453, -488, -523, -558, -593, -627, -662,
-697, -732, -767, -802, -837, -871, -906, -941, -976, -1011, -1046, -1081, -1115, -1150, -1185, -1220, -1255, -1290,
-1325, -1359, 0, -36, -72, -107, -143, -179, -215, -251, -286, -322, -358, -394, -429, -465, -501, -537, -573, -608,
-644, -680, -716, -752, -787, -823, -859, -895, -930, -966, -1002, -1038, -1074, -1109, -1145, -1181, -1217, -1253,
-1288, -1324, -1360, -1396, 0, -37, -73, -110, -147, -184, -220, -257, -294, -330, -367, -404, -441, -477, -514, -551,
-587, -624, -661, -697, -734, -771, -808, -844, -881, -918, -954, -991, -1028, -1065, -1101, -1138, -1175, -1211, -1248,
-1285, -1322, -1358, -1395, -1432, 0, -38, -75, -113, -150, -188, -226, -263, -301, -339, -376, -414, -451, -489, -527,
-564, -602, -640, -677, -715, -752, -790, -828, -865, -903, -940, -978, -1016, -1053, -1091, -1129, -1166, -1204, -1241,
-1279, -1317, -1354, -1392, -1429, -1467, 0, -39, -77, -116, -154, -193, -231, -270, -308, -347, -385, -424, -462, -501,
-539, -578, -616, -655, -693, -732, -770, -809, -847, -886, -924, -963, -1001, -1040, -1078, -1117, -1155, -1194, -1233,
-1271, -1310, -1348, -1387, -1425, -1464, -1502, 0, -39, -79, -118, -158, -197, -236, -276, -315, -355, -394, -433, -473,
-512, -552, -591, -630, -670, -709, -749, -788, -827, -867, -906, -946, -985, -1024, -1064, -1103, -1143, -1182, -1221,
-1261, -1300, -1340, -1379, -1418, -1458, -1497, -1537, 0, -40, -81, -121, -161, -201, -242, -282, -322, -362, -403, -443,
-483, -524, -564, -604, -644, -685, -725, -765, -806, -846, -886, -926, -967, -1007, -1047, -1087, -1128, -1168, -1208,
-1249, -1289, -1329, -1369, -1410, -1450, -1490, -1531, -1571, 0, -41, -82, -123, -165, -206, -247, -288, -329, -370, -411,
-453, -494, -535, -576, -617, -658, -699, -740, -782, -823, -864, -905, -946, -987, -1028, -1070, -1111, -1152, -1193,
-1234, -1275, -1316, -1358, -1399, -1440, -1481, -1522, -1563, -1604, 0, -42, -84, -126, -168, -210, -252, -294, -336,
-378, -420, -462, -504, -546, -588, -630, -672, -714, -756, -798, -840, -882, -924, -966, -1008, -1050, -1092, -1134,
-1176, -1218, -1260, -1302, -1344, -1386, -1428, -1470, -1512, -1554, -1596, -1638, 0, -43, -86, -128, -171, -214, -257,
-300, -343, -385, -428, -471, -514, -557, -600, -642, -685, -728, -771, -814, -856, -899, -942, -985, -1028, -1071, -1113,
-1156, -1199, -1242, -1285, -1328, -1370, -1413, -1456, -1499, -1542, -1585, -1627, -1670, 0, -44, -87, -131, -175, -218,
-262, -306, -349, -393, -436, -480, -524, -567, -611, -655, -698, -742, -786, -829, -873, -917, -960, -1004, -1048, -1091,
-1135, -1178, -1222, -1266, -1309, -1353, -1397, -1440, -1484, -1528, -1571, -1615, -1659, -1702, 0, -44, -89, -133, -178,
-222, -267, -311, -356, -400, -445, -489, -533, -578, -622, -667, -711, -756, -800, -845, -889, -934, -978, -1023, -1067,
-1111, -1156, -1200, -1245, -1289, -1334, -1378, -1423, -1467, -1512, -1556, -1600, -1645, -1689, -1734, 0, -45, -91,
-136, -181, -226, -272, -317, -362, -407, -453, -498, -543, -588, -634, -679, -724, -769, -815, -860, -905, -950, -996,
-1041, -1086, -1131, -1177, -1222, -1267, -1312, -1358, -1403, -1448, -1493, -1539, -1584, -1629, -1674, -1720, -1765,
0, -46, -92, -138, -184, -230, -276, -322, -368, -414, -460, -506, -552, -598, -645, -691, -737, -783, -829, -875, -921,
-967, -1013, -1059, -1105, -1151, -1197, -1243, -1289, -1335, -1381, -1427, -1473, -1519, -1565, -1611, -1657, -1703,
-1749, -1795, 0, -47, -94, -140, -187, -234, -281, -328, -374, -421, -468, -515, -562, -608, -655, -702, -749, -796,
-843, -889, -936, -983, -1030, -1077, -1123, -1170, -1217, -1264, -1311, -1357, -1404, -1451, -1498, -1545, -1591, -1638,
-1685, -1732, -1779, -1825, 0, -48, -95, -143, -190, -238, -285, -333, -380, -428, -476, -523, -571, -618, -666, -713,
-761, -809, -856, -904, -951, -999, -1046, -1094, -1141, -1189, -1237, -1284, -1332, -1379, -1427, -1474, -1522, -1570,
-1617, -1665, -1712, -1760, -1807, -1855, 0, -48, -97, -145, -193, -242, -290, -338, -386, -435, -483, -531, -580, -628,
-676, -725, -773, -821, -869, -918, -966, -1014, -1063, -1111, -1159, -1208, -1256, -1304, -1352, -1401, -1449, -1497,
-1546, -1594, -1642, -1691, -1739, -1787, -1835, -1884, 0, -49, -98, -147, -196, -245, -294, -343, -392, -441, -490, -539,
-588, -637, -686, -735, -784, -833, -882, -932, -981, -1030, -1079, -1128, -1177, -1226, -1275, -1324, -1373, -1422, -1471,
-1520, -1569, -1618, -1667, -1716, -1765, -1814, -1863, -1912, 0, -50, -99, -149, -199, -249, -298, -348, -398, -448,
-497, -547, -597, -647, -696, -746, -796, -846, -895, -945, -995, -1044, -1094, -1144, -1194, -1243, -1293, -1343, -1393,
-1442, -1492, -1542, -1592, -1641, -1691, -1741, -1791, -1840, -1890, -1940, 0, -50, -101, -151, -202, -252, -303, -353,
-403, -454, -504, -555, -605, -656, -706, -756, -807, -857, -908, -958, -1009, -1059, -1110, -1160, -1210, -1261, -1311,
-1362, -1412, -1463, -1513, -1563, -1614, -1664, -1715, -1765, -1816, -1866, -1916, -1967, 0, -51, -102, -153, -204, -256,
-307, -358, -409, -460, -511, -562, -613, -664, -716, -767, -818, -869, -920, -971, -1022, -1073, -1124, -1176, -1227,
-1278, -1329, -1380, -1431, -1482, -1533, -1584, -1636, -1687, -1738, -1789, -1840, -1891, -1942, -1993, 0, -52, -104,
-155, -207, -259, -311, -362, -414, -466, -518, -570, -621, -673, -725, -777, -828, -880, -932, -984, -1036, -1087, -1139,
-1191, -1243, -1294, -1346, -1398, -1450, -1502, -1553, -1605, -1657, -1709, -1760, -1812, -1864, -1916, -1968, -2019,
0, -52, -105, -157, -210, -262, -315, -367, -419, -472, -524, -577, -629, -682, -734, -786, -839, -891, -944, -996, -1049,
-1101, -1153, -1206, -1258, -1311, -1363, -1415, -1468, -1520, -1573, -1625, -1678, -1730, -1782, -1835, -1887, -1940,
-1992, -2045, 0, -53, -106, -159, -212, -265, -318, -371, -424, -478, -531, -584, -637, -690, -743, -796, -849, -902,
-955, -1008, -1061, -1114, -1167, -1220, -1273, -1326, -1380, -1433, -1486, -1539, -1592, -1645, -1698, -1751, -1804,
-1857, -1910, -1963, -2016, -2069, 0, -54, -107, -161, -215, -268, -322, -376, -429, -483, -537, -590, -644, -698, -751,
-805, -859, -912, -966, -1020, -1073, -1127, -1181, -1235, -1288, -1342, -1396, -1449, -1503, -1557, -1610, -1664, -1718,
-1771, -1825, -1879, -1932, -1986, -2040, -2093, 0, -54, -109, -163, -217, -271, -326, -380, -434, -488, -543, -597, -651,
-706, -760, -814, -868, -923, -977, -1031, -1086, -1140, -1194, -1248, -1303, -1357, -1411, -1465, -1520, -1574, -1628,
-1683, -1737, -1791, -1845, -1900, -1954, -2008, -2062, -2117, 0, -55, -110, -165, -219, -274, -329, -384, -439, -494,
-549, -603, -658, -713, -768, -823, -878, -933, -987, -1042, -1097, -1152, -1207, -1262, -1317, -1371, -1426, -1481,
-1536, -1591, -1646, -1701, -1755, -1810, -1865, -1920, -1975, -2030, -2085, -2139, 0, -55, -111, -166, -222, -277,
-333, -388, -443, -499, -554, -610, -665, -721, -776, -831, -887, -942, -998, -1053, -1109, -1164, -1219, -1275, -1330,
-1386, -1441, -1496, -1552, -1607, -1663, -1718, -1774, -1829, -1884, -1940, -1995, -2051, -2106, -2162, 0, -56, -112,
-168, -224, -280, -336, -392, -448, -504, -560, -616, -672, -728, -784, -840, -896, -952, -1008, -1064, -1120, -1175,
-1231, -1287, -1343, -1399, -1455, -1511, -1567, -1623, -1679, -1735, -1791, -1847, -1903, -1959, -2015, -2071, -2127,
-2183, 0, -57, -113, -170, -226, -283, -339, -396, -452, -509, -565, -622, -678, -735, -791, -848, -904, -961, -1017,
-1074, -1130, -1187, -1243, -1300, -1356, -1413, -1469, -1526, -1582, -1639, -1695, -1752, -1808, -1865, -1921, -1978,
-2034, -2091, -2147, -2204, 0, -57, -114, -171, -228, -285, -342, -399, -456, -513, -570, -627, -684, -741, -798, -855,
-912, -969, -1026, -1083, -1140, -1198, -1255, -1312, -1369, -1426, -1483, -1540, -1597, -1654, -1711, -1768, -1825,
-1882, -1939, -1996, -2053, -2110, -2167, -2224, 0, -58, -115, -173, -230, -288, -345, -403, -460, -518, -575, -633,
-690, -748, -805, -863, -920, -978, -1035, -1093, -1150, -1208, -1266, -1323, -1381, -1438, -1496, -1553, -1611, -1668,
-1726, -1783, -1841, -1898, -1956, -2013, -2071, -2128, -2186, -2243, 0, -58, -116, -174, -232, -290, -348, -406, -464,
-522, -580, -638, -696, -754, -812, -870, -928, -986, -1044, -1102, -1160, -1218, -1276, -1334, -1392, -1450, -1508,
-1566, -1624, -1682, -1740, -1798, -1856, -1914, -1972, -2030, -2088, -2146, -2204, -2262, 0, -58, -117, -175, -234,
-292, -351, -409, -468, -526, -585, -643, -702, -760, -819, -877, -935, -994, -1052, -1111, -1169, -1228, -1286, -1345,
-1403, -1462, -1520, -1579, -1637, -1696, -1754, -1812, -1871, -1929, -1988, -2046, -2105, -2163, -2222, -2280, 0, -59,
-118, -177, -236, -295, -353, -412, -471, -530, -589, -648, -707, -766, -825, -884, -943, -1002, -1060, -1119, -1178,
-1237, -1296, -1355, -1414, -1473, -1532, -1591, -1650, -1708, -1767, -1826, -1885, -1944, -2003, -2062, -2121, -2180,
-2239, -2298, 0, -59, -119, -178, -237, -297, -356, -415, -475, -534, -593, -653, -712, -771, -831, -890, -949, -1009,
-1068, -1127, -1187, -1246, -1305, -1365, -1424, -1483, -1543, -1602, -1662, -1721, -1780, -1840, -1899, -1958, -2018,
-2077, -2136, -2196, -2255, -2314, 0, -60, -119, -179, -239, -299, -358, -418, -478, -538, -597, -657, -717, -777, -836,
-896, -956, -1016, -1075, -1135, -1195, -1255, -1314, -1374, -1434, -1494, -1553, -1613, -1673, -1733, -1792, -1852,
-1912, -1972, -2031, -2091, -2151, -2211, -2270, -2330, 0, -60, -120, -180, -241, -301, -361, -421, -481, -541, -601,
-662, -722, -782, -842, -902, -962, -1022, -1083, -1143, -1203, -1263, -1323, -1383, -1443, -1504, -1564, -1624, -1684,
-1744, -1804, -1864, -1924, -1985, -2045, -2105, -2165, -2225, -2285, -2345, 0, -61, -121, -182, -242, -303, -363, -424,
-484, -545, -605, -666, -726, -787, -847, -908, -968, -1029, -1089, -1150, -1210, -1271, -1331, -1392, -1452, -1513,
-1573, -1634, -1694, -1755, -1815, -1876, -1936, -1997, -2057, -2118, -2178, -2239, -2300, -2360, 0, -61, -122, -183,
-243, -304, -365, -426, -487, -548, -609, -670, -730, -791, -852, -913, -974, -1035, -1096, -1156, -1217, -1278, -1339,
-1400, -1461, -1522, -1583, -1643, -1704, -1765, -1826, -1887, -1948, -2009, -2069, -2130, -2191, -2252, -2313, -2374,
0, -61, -122, -184, -245, -306, -367, -428, -490, -551, -612, -673, -734, -796, -857, -918, -979, -1040, -1102, -1163,
-1224, -1285, -1346, -1408, -1469, -1530, -1591, -1652, -1714, -1775, -1836, -1897, -1959, -2020, -2081, -2142, -2203,
-2265, -2326, -2387, 0, -62, -123, -185, -246, -308, -369, -431, -492, -554, -615, -677, -738, -800, -861, -923, -984,
-1046, -1107, -1169, -1230, -1292, -1353, -1415, -1476, -1538, -1600, -1661, -1723, -1784, -1846, -1907, -1969, -2030,
-2092, -2153, -2215, -2276, -2338, -2399, 0, -62, -124, -185, -247, -309, -371, -433, -495, -556, -618, -680, -742,
-804, -865, -927, -989, -1051, -1113, -1175, -1236, -1298, -1360, -1422, -1484, -1545, -1607, -1669, -1731, -1793, -1855,
-1916, -1978, -2040, -2102, -2164, -2225, -2287, -2349, -2411, 0, -62, -124, -186, -248, -310, -373, -435, -497, -559,
-621, -683, -745, -807, -869, -931, -994, -1056, -1118, -1180, -1242, -1304, -1366, -1428, -1490, -1552, -1615, -1677,
-1739, -1801, -1863, -1925, -1987, -2049, -2111, -2173, -2236, -2298, -2360, -2422, 0, -62, -125, -187, -249, -312,
-374, -437, -499, -561, -624, -686, -748, -811, -873, -935, -998, -1060, -1122, -1185, -1247, -1310, -1372, -1434,
-1497, -1559, -1621, -1684, -1746, -1808, -1871, -1933, -1996, -2058, -2120, -2183, -2245, -2307, -2370, -2432, 0,
-63, -125, -188, -250, -313, -376, -438, -501, -563, -626, -689, -751, -814, -876, -939, -1002, -1064, -1127, -1189,
-1252, -1315, -1377, -1440, -1502, -1565, -1628, -1690, -1753, -1815, -1878, -1941, -2003, -2066, -2128, -2191, -2254,
-2316, -2379, -2441, 0, -63, -126, -188, -251, -314, -377, -440, -503, -565, -628, -691, -754, -817, -880, -942, -1005,
-1068, -1131, -1194, -1256, -1319, -1382, -1445, -1508, -1571, -1633, -1696, -1759, -1822, -1885, -1948, -2010, -2073,
-2136, -2199, -2262, -2324, -2387, -2450, 0, -63, -126, -189, -252, -315, -378, -441, -504, -567, -630, -693, -756,
-819, -882, -945, -1008, -1071, -1134, -1198, -1261, -1324, -1387, -1450, -1513, -1576, -1639, -1702, -1765, -1828,
-1891, -1954, -2017, -2080, -2143, -2206, -2269, -2332, -2395, -2458, 0, -63, -126, -190, -253, -316, -379, -442, -506,
-569, -632, -695, -759, -822, -885, -948, -1011, -1075, -1138, -1201, -1264, -1327, -1391, -1454, -1517, -1580, -1644,
-1707, -1770, -1833, -1896, -1960, -2023, -2086, -2149, -2212, -2276, -2339, -2402, -2465, 0, -63, -127, -190, -254,
-317, -380, -444, -507, -570, -634, -697, -761, -824, -887, -951, -1014, -1077, -1141, -1204, -1268, -1331, -1394,
-1458, -1521, -1584, -1648, -1711, -1775, -1838, -1901, -1965, -2028, -2091, -2155, -2218, -2282, -2345, -2408, -2472,
0, -64, -127, -191, -254, -318, -381, -445, -508, -572, -635, -699, -762, -826, -889, -953, -1016, -1080, -1143, -1207,
-1270, -1334, -1398, -1461, -1525, -1588, -1652, -1715, -1779, -1842, -1906, -1969, -2033, -2096, -2160, -2223, -2287,
-2350, -2414, -2477, 0, -64, -127, -191, -255, -318, -382, -446, -509, -573, -636, -700, -764, -827, -891, -955, -1018,
-1082, -1146, -1209, -1273, -1337, -1400, -1464, -1528, -1591, -1655, -1719, -1782, -1846, -1909, -1973, -2037, -2100,
-2164, -2228, -2291, -2355, -2419, -2482, 0, -64, -128, -191, -255, -319, -383, -446, -510, -574, -638, -701, -765,
-829, -893, -956, -1020, -1084, -1148, -1211, -1275, -1339, -1403, -1466, -1530, -1594, -1658, -1721, -1785, -1849,
-1913, -1976, -2040, -2104, -2168, -2231, -2295, -2359, -2423, -2487, 0, -64, -128, -192, -255, -319, -383, -447, -511,
-575, -638, -702, -766, -830, -894, -958, -1022, -1085, -1149, -1213, -1277, -1341, -1405, -1468, -1532, -1596, -1660,
-1724, -1788, -1851, -1915, -1979, -2043, -2107, -2171, -2235, -2298, -2362, -2426, -2490, 0, -64, -128, -192, -256,
-320, -383, -447, -511, -575, -639, -703, -767, -831, -895, -959, -1023, -1087, -1150, -1214, -1278, -1342, -1406, -1470,
-1534, -1598, -1662, -1726, -1790, -1853, -1917, -1981, -2045, -2109, -2173, -2237, -2301, -2365, -2429, -2493, 0, -64,
-128, -192, -256, -320, -384, -448, -512, -576, -640, -704, -768, -831, -895, -959, -1023, -1087, -1151, -1215, -1279,
-1343, -1407, -1471, -1535, -1599, -1663, -1727, -1791, -1855, -1919, -1983, -2047, -2111, -2175, -2239, -2303, -2367,
-2431, -2494, 0, -64, -128, -192, -256, -320, -384, -448, -512, -576, -640, -704, -768, -832, -896, -960, -1024, -1088,
-1152, -1216, -1280, -1344, -1408, -1472, -1536, -1600, -1664, -1728, -1792, -1856, -1920, -1984, -2048, -2112, -2176,
-2240, -2304, -2368, -2432, -2496 };

void generate_pcm_in(int channel, int sample, vector<float> &input)
{
	srand(1);
	input.resize(channel*sample);
	for (int i = 0; i < channel; i++)
	{
		for (int j = 0; j < sample; j++)
			input[i*sample + j] = 128 << (rand() & 7);
	}
}

void * init_watersound_processContext(bool gpu)
{
	SpaceFilter * space_filter;
	short nt_reverse[180 * CHANNEL_NUM];
	for (int i = 0; i < 180; i++)
		for (int j = 0; j < CHANNEL_NUM; j++)
			nt_reverse[i * CHANNEL_NUM + j] = N_t[(179 - i) * CHANNEL_NUM + j];
	if (gpu)
		space_filter = new SpaceFilterGPU(CHANNEL_NUM, 16000);
	else
		space_filter = new SpaceFilterCPU(CHANNEL_NUM, 16000);
	space_filter->set_sf_para(nt_reverse);
	return (void *) space_filter;
}

void watersound_set_noise_para(void * context, bool enable, float angle)
{
	if (context == NULL)
		return;
	SpaceFilter * space_filter = (SpaceFilter *)context;
	space_filter->set_noise_para(enable, angle);
}

void watersound_process(void * context, float * pcm_input, float * pcm_output)
{
	if (context == NULL)
		return;
	SpaceFilter * space_filter = (SpaceFilter *)context;
	vector <float*> pcm_in(CHANNEL_NUM);
	vector <float*> pcm_out(180);
	for (int i = 0; i < CHANNEL_NUM; i++)
		pcm_in[i] = &pcm_input[i * 16000];
	for (int i = 0; i < 180; i++)
		pcm_out[i] = &pcm_output[i * 2000];
	space_filter->process(pcm_in, pcm_out);
}

void watersound_set_target(void * context, float * target, int target_len)
{
	if (context == NULL)
		return;
	SpaceFilter * space_filter = (SpaceFilter *)context;
	space_filter->set_target(target, target_len);
}

void * init_watersound_freq_processContext()
{
	SpaceFilterFreqGPU * space_freq_filter = new SpaceFilterFreqGPU(CHANNEL_NUM, 16000);
	return (void *)space_freq_filter;
}

bool l_enable=false, s_enable=false;
float l_angle, s_angle;
void watersound_freq_set_noise_para(void *context, bool enable1, float angle1, bool enable2, float angle2)
{
	l_enable = enable1;
	l_angle = angle1;
	s_enable = enable2;
	s_angle = angle2;
}

void watersound_freq_process(void * context, float * input1, float * input2, float * output1, float * output2, int start_freq, int freq_num)
{
	if (context == NULL)
		return;
	SpaceFilterFreqGPU * space_freq_filter = (SpaceFilterFreqGPU *)context;
	space_freq_filter->process(input1, output1, 10, 91, 4, l_enable, l_angle, 2);
	space_freq_filter->process(input2, output2, start_freq, freq_num, 2, s_enable, s_angle, 1);
}

#ifndef STATIC_LIB
void test1()
{
#define target_len 100
	float target[target_len];
	void * space_filter_gpu = init_watersound_processContext(true);
	void * space_filter_cpu = init_watersound_processContext(false);
	for (int i = 0; i < target_len; i++)
		target[i] = rand() % 16;
	watersound_set_target(space_filter_cpu, target, target_len);
	watersound_set_target(space_filter_gpu, target, target_len);
	vector <float> input, input1;
	vector <float> output(180 * 2000);
	generate_pcm_in(CHANNEL_NUM, 16000, input);
	generate_pcm_in(CHANNEL_NUM, 16000, input1);
	clock_t t0 = clock();
	watersound_process(space_filter_gpu, &input[0], &output[0]);
	watersound_process(space_filter_gpu, &input[0], &output[0]);
	watersound_process(space_filter_gpu, &input1[0], &output[0]);
	watersound_process(space_filter_gpu, &input1[0], &output[0]);
	watersound_process(space_filter_gpu, &input[0], &output[0]);
	clock_t t1 = clock();
	watersound_process(space_filter_cpu, &input[0], &output[0]);
	watersound_process(space_filter_cpu, &input[0], &output[0]);
	watersound_process(space_filter_cpu, &input1[0], &output[0]);
	watersound_process(space_filter_cpu, &input1[0], &output[0]);
	watersound_process(space_filter_cpu, &input[0], &output[0]);
	clock_t t2 = clock();
	printf("finished, gpu time=%f, cpu time=%f\n", (double)(t1 - t0) / CLOCKS_PER_SEC, (double)(t2 - t1) / CLOCKS_PER_SEC);	
}

void test2()
{
	void * space_filter_gpu = init_watersound_freq_processContext();
	watersound_freq_set_noise_para(space_filter_gpu, true, 30, true, 30);
	float t1_yanci, t2_yanci;
	t1_yanci = -cos(30 * pi / 180) * 4 / 1500;
	t2_yanci = -cos(70 * pi / 180) * 4 / 1500;
	vector <float> input1, input2, output1, output2;
	input1.resize(CHANNEL_NUM * 16000);
	output1.resize(91 * 180);
	for (int i = 0; i < CHANNEL_NUM; i++)
		for (int j = 0; j < 16000; j++)
			input1[i * 16000 + j] = cos(2 * pi * 50 * (j+1 + (i+1)*t1_yanci*16000)/16000) * 10 + 
			cos(2 * pi * 50 * (j+1 + (i+1)*t2_yanci*16000)/16000);
	input2.resize(CHANNEL_NUM * 16000);
	output2.resize(3 * 180);
	t1_yanci = -cos(30 * pi / 180) * 2 / 1500;
	t2_yanci = -cos(70 * pi / 180) * 2 / 1500;
	for (int i = 0; i < CHANNEL_NUM; i++)
		for (int j = 0; j < 16000; j++)
			input2[i * 16000 + j] = cos(2 * pi * 400 * (j + 1 + (i + 1)*t1_yanci * 16000) / 16000) * 10 +
			cos(2 * pi * 400 * (j + 1 + (i + 1)*t2_yanci * 16000) / 16000);
	clock_t t0 = clock();
	watersound_freq_process(space_filter_gpu, &input1[0], &input2[0], &output1[0], &output2[0],399,3);
	clock_t t1 = clock();
	printf("finished, gpu time=%f\n", (double)(t1 - t0) / CLOCKS_PER_SEC);
}

int main()
{
	/*
	cudaDeviceProp properties;
	cudaGetDeviceProperties(&properties, 0);
	printf("cap=%d.%d,globalL1=%d,localL1=%d,L2size=%d\n", properties.major, properties.minor,
	properties.globalL1CacheSupported, properties.localL1CacheSupported, properties.l2CacheSize);*/
	/*
#define NX 64
#define BATCH 2
	cufftHandle plan;
	float x[BATCH][NX], xx[BATCH][NX], f[BATCH][NX + 2];
	cufftComplex y[BATCH][(NX / 2 + 1)];
	FFTCPU fft;

	srand(1);
	for (int i = 0; i < BATCH; i++)
		for (int j = 0; j < NX; j++)
			x[i][j] = rand() % 128;
	for (int i = 0; i < BATCH; i++)
		fft.RealFFT(x[i], f[i], NX);
	cufftReal *in_data_gpu;
	cufftComplex *out_data_gpu;
	cudaMalloc((void**)&in_data_gpu, sizeof(x));
	cudaMalloc((void**)&out_data_gpu, sizeof(y));
	if (cudaGetLastError() != cudaSuccess){
		fprintf(stderr, "Cuda error: Failed to allocate\n");
		return -1;
	}
	
	if (cufftPlan1d(&plan, NX, CUFFT_R2C, BATCH) != CUFFT_SUCCESS){
		fprintf(stderr, "CUFFT error: Plan creation failed");
		return -1;
	}
	cudaMemcpy(in_data_gpu, x, sizeof(x), cudaMemcpyHostToDevice);
	if (cudaGetLastError() != cudaSuccess){
		fprintf(stderr, "Cuda error: copy host to gpu\n");
		return -1;
	}
	cufftExecR2C(plan, in_data_gpu, out_data_gpu);
	cufftExecC2R(plan, out_data_gpu, in_data_gpu);
	if (cudaGetLastError() != cudaSuccess){
		fprintf(stderr, "Cuda error: Failed to execute\n");
		return -1;
	}
	cudaMemcpy(y, out_data_gpu, sizeof(y), cudaMemcpyDeviceToHost);
	cudaMemcpy(xx, in_data_gpu, sizeof(xx), cudaMemcpyDeviceToHost);
	if (cudaGetLastError() != cudaSuccess){
		fprintf(stderr, "Cuda error: Failed to execute\n");
		return -1;
	}
	for (int i = 0; i < BATCH; i++)
		fft.RealIFFT(f[i], x[i], NX);

	for (int i = 0; i < BATCH; i++) {
		printf("batch: %d\n", i);
		for (int j = 0; j < NX / 2 + 1; j++)
			printf("%f+j%f : %f+j%f\n", f[i][j * 2], f[i][j * 2 + 1], y[i][j].x, y[i][j].y);
	}
	for (int i = 0; i < BATCH; i++) {
		printf("batch: %d\n", i);
		for (int j = 0; j < NX; j++)
			printf("%f: %f\n", xx[i][j], x[i][j]);
	}
*/
	test1(); 
	getchar();
	return 0;
}
#endif